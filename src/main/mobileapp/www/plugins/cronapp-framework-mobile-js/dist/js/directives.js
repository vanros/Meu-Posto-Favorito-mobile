!function($app){var patternFormat=function(e){return e?$(e).attr("format")||"DD/MM/YYYY":"DD/MM/YYYY"},parsePermission=function(e){var t={visible:{public:!0},enabled:{public:!0}};if(e)for(var r=e.toLowerCase().trim().split(","),i=0;i<r.length;i++){var a=r[i].trim();if(a){var n=a.split(":");if(2==n.length){var o=n[0].trim(),s=n[1].trim();if(s){for(var l=s.split(";"),c={},d=0;d<l.length;d++){var u=l[d].trim();u&&(c[u]=!0)}t[o]=c}}}}return t};app.directive("asDate",function(){return{require:"^ngModel",restrict:"A",link:function(e,t,r,i){function a(){var e=t.val(),r=moment(e,patternFormat(t));r.isValid()&&i.$setViewValue(r.toDate())}if(i){var n=patternFormat(t),o={format:n,locale:"pt-BR",showTodayButton:!0,useStrict:!0,tooltips:{today:"Hoje",clear:"Limpar seleção",close:"Fechar",selectMonth:"Selecionar mês",prevMonth:"Mês anterior",nextMonth:"Próximo mês",selectYear:"Selecionar ano",prevYear:"Ano anterior",nextYear:"Próximo ano",selectDecade:"Selecionar década",prevDecade:"Década anterior",nextDecade:"Próxima década",prevCentury:"Século anterior",nextCentury:"Próximo século"}};"DD/MM/YYYY"!=n&&(o.sideBySide=!0),t.datetimepicker(o),t.on("dp.change",function(){$(this).is(":visible")&&e.$apply(a)}),i.$render=function(){if(i.$viewValue){var e=parseInt(i.$viewValue,10),r=moment(e);r.isValid()?t.val(r.format(patternFormat(t))):t.val("")}else t.data("DateTimePicker").clear(),t.val("")},a()}}}}).directive("ngDestroy",function(){return{restrict:"A",link:function(scope,element,attrs,ctrl){element.on("$destroy",function(){attrs.ngDestroy&&attrs.ngDestroy.length>0&&(attrs.ngDestroy.indexOf("app.")>-1||attrs.ngDestroy.indexOf("blockly.")>-1?scope.$eval(attrs.ngDestroy):eval(attrs.ngDestroy))})}}}).directive("pwCheck",[function(){"use strict";return{require:"ngModel",link:function(e,t,r,i){var a="#"+r.pwCheck;t.add(a).on("keyup",function(){e.$apply(function(){var e=t.val()===$(a).val();i.$setValidity("pwmatch",e)})})}}}]).directive("valid",function(){return{require:"^ngModel",restrict:"A",link:function(e,t,r,i){var a={cpf:CPF,cnpj:CNPJ};i.$validators[r.valid]=function(e,i){var n=e||i,o=a[r.valid].isValid(n);return o?t[0].setCustomValidity(""):t[0].setCustomValidity(t[0].dataset.errorMessage),o||!n}}}}).directive("cronappSecurity",function(){return{restrict:"A",link:function(e,t,r){var i=[];e.session&&e.session.roles&&(i=e.session.roles.toLowerCase().split(","));for(var a=parsePermission(r.cronappSecurity),n=!1,o=!1,s=0;s<i.length;s++){var l=i[s].trim();l&&(a.visible[l]&&(n=!0),a.enabled[l]&&(o=!0))}n||$(t).hide(),o||$(t).find("*").addBack().attr("disabled",!0)}}}).directive("cronappStars",[function(){"use strict";return{restrict:"A",require:"ngModel",link:function(e,t,r,i){function a(e){for(var t=1;t<=5;t++)s[t-1].removeClass("ion-android-star-outline"),s[t-1].removeClass("ion-android-star"),t<=e?s[t-1].addClass("ion-android-star"):s[t-1].addClass("ion-android-star-outline");return e}var n=$(t),o=$(n.children().get(0));n.html("");for(var s=[],l=1;l<=5;l++){var c=o.clone();n.append(c),c.attr("idx",l),c.click(function(){e.$apply(function(){i.$viewValue=parseInt($(this).attr("idx")),i.$commitViewValue()}.bind(this))}),s.push(c)}i.$parsers.push(a),i.$formatters.push(a)}}}])}(app);