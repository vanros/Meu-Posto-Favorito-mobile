(function(){"use strict";this.cronapi={},this.cronapi.doEval=function(t){return t},this.cronapi.evalInContext=function(js){var result=eval("this.cronapi.doEval("+js+")");if(result&&result.commands)for(var i=0;i<result.commands.length;i++){var func=eval(result.commands[i].function);func.apply(this,result.commands[i].params)}if(result&&result.value)return result.value},this.cronapi.conversion={},this.cronapi.conversion.asciiToBinary=function(t){var e="";if(t.length>0)for(var n=0;n<t.length;n++)for(var i=t.charCodeAt(n),r=7;r>=0;r--)e+=i>>r&1;return e},this.cronapi.conversion.toBoolean=function(t){return this.cronapi.internal.parseBoolean(t)},this.cronapi.conversion.toBytes=function(t){return t?t.toString():""},this.cronapi.conversion.chrToAscii=function(t){return t?t.charCodeAt(0):null},this.cronapi.conversion.stringToJs=function(t){return this.cronapi.internal.stringToJs(t)},this.cronapi.conversion.stringToDate=function(value){var pattern=/^\s*(\d+)[\/\.-](\d+)[\/\.-](\d+)(\s(\d+):(\d+):(\d+))?\s*$/;if(value){if(value instanceof Date)return value;if(pattern.test(value)){var splited=pattern.exec(value),userLang=(navigator.language||navigator.userLanguage).split("-")[0];if("pt"==userLang||"en"==userLang){var functionToCall=eval(userLang+"Date");return functionToCall(splited)}return new Date(value)}return new Date(value)}return null},this.cronapi.conversion.intToHex=function(t){return Number(t).toString(16).toUpperCase()},this.cronapi.conversion.toLong=function(t){return parseInt(t)},this.cronapi.conversion.toString=function(t){if(t){return new String(t).toString()}return""},this.cronapi.util={},this.cronapi.util.callServerBlocklyAsync=function(t,e,n,i){var r="api/cronapi/call/body/#classNameWithMethod#/".replace("#classNameWithMethod#",t),o=(this.cronapi.$scope.http,[]);$(arguments).each(function(){o.push(this)});var a="";window.uToken&&(a=window.uToken);var c={fields:e,inputs:o.slice(4)};$.ajax({type:"POST",url:(window.hostApp||"")+r,dataType:"html",data:JSON.stringify(c),headers:{"Content-Type":"application/json","X-AUTH-TOKEN":a,toJS:!0},success:n,error:i})},this.cronapi.util.getScreenFields=function(){var t={};for(var e in this.cronapi.$scope)this.cronapi.$scope[e]&&this.cronapi.$scope[e].constructor&&"DataSet"==this.cronapi.$scope[e].constructor.name&&(t[e]={},t[e].active=this.cronapi.$scope[e].active);for(var e in this.cronapi.$scope.vars)this.cronapi.$scope.vars[e]&&(t.vars||(t.vars={}),t.vars[e]=this.cronapi.$scope.vars[e]);for(var e in this.cronapi.$scope.params)this.cronapi.$scope.params[e]&&(t.params||(t.params={}),t.params[e]=this.cronapi.$scope.params[e]);return t},this.cronapi.util.makeCallServerBlocklyAsync=function(blocklyWithFunction,callbackSuccess,callbackError){var fields=this.cronapi.util.getScreenFields(),paramsApply=[];paramsApply.push(blocklyWithFunction),paramsApply.push(fields),paramsApply.push(function(data){var result=this.cronapi.evalInContext(data);"string"==typeof callbackSuccess?eval(callbackSuccess)(result):callbackSuccess&&callbackSuccess(result)}.bind(this)),paramsApply.push(function(data,status,errorThrown){var message=this.cronapi.internal.getErrorMessage(data.responseText,errorThrown);"string"==typeof callbackError?eval(callbackError)(message):callbackError?callbackError(message):this.cronapi.$scope.Notification.error(message)}.bind(this)),$(arguments).each(function(t){t>=3&&paramsApply.push(this)}),this.cronapi.util.callServerBlocklyAsync.apply(this,paramsApply)},this.cronapi.util.callServerBlocklyNoReturn=function(){this.cronapi.util.callServerBlockly.apply(this,arguments)},this.cronapi.util.throwException=function(t){throw t},this.cronapi.util.createException=function(t){return t},this.cronapi.util.callServerBlockly=function(t){for(var e="api/cronapi/call/body/#classNameWithMethod#/".replace("#classNameWithMethod#",t),n=[],i=this.cronapi.util.getScreenFields(),r={fields:i,inputs:n},o=1;o<arguments.length;o++)n.push(arguments[o]);var a="";window.uToken&&(a=window.uToken);var c=$.ajax({type:"POST",url:(window.hostApp||"")+e,dataType:"html",data:JSON.stringify(r),async:!1,headers:{"Content-Type":"application/json","X-AUTH-TOKEN":a,toJS:!0}});if(200!=c.status){var s=this.cronapi.internal.getErrorMessage(c.responseText,c.statusText);throw this.cronapi.$scope.Notification.error(s),s}return c.responseJSON?c.responseJSON:this.cronapi.evalInContext(c.responseText)},this.cronapi.util.executeJavascriptNoReturn=function(value){eval(value)},this.cronapi.util.downloadFile=function(t){var e,n="IFRAME"+parseInt(9999999*Math.random());document.all?e=window.document.createElement("<iframe name='"+n+"' id='"+n+"'>"):(e=window.document.createElement("iframe"),e.name=n,e.id=n),e.frameBorder=0,e.setAttribute("frameborder","no"),e.setAttribute("border",0),e.setAttribute("marginwidth",0),e.setAttribute("marginheight",0),e.width=0,e.height=0,e.src=t,window.document.body.appendChild(e)},this.cronapi.util.executeJavascriptNoReturn=function(value){eval(value)},this.cronapi.util.executeJavascriptReturn=function(value){return eval(value)},this.cronapi.util.openReport=function(t){this.cronapi.$scope.getReport(t)},this.cronapi.util.executeAsynchronous=function(t){setTimeout(t,0)},this.cronapi.util.scheduleExecution=function(t,e,n,i){var r=1;"seconds"==i?r=1e3:"minutes"==i?r=6e4:"hours"==i&&(r=36e5),e*=r,n*=r;var o=-1,a=setTimeout(function(){t(),o=setInterval(t,n)}.bind(this),e);this.$on("$destroy",function(){try{clearTimeout(a)}catch(t){}try{clearInterval(o)}catch(t){}})},this.cronapi.util.openReport=function(t,e){this.cronapi.$scope.getReport(t,e)},this.cronapi.screen={},this.cronapi.screen.fieldFromScreen=function(t){return t},this.cronapi.screen.changeValueOfField=function(t,e){try{this.__tempValue=e;var n=new Function("this."+t+" = this.__tempValue;");this.safeApply(n.bind(this))}catch(t){}},this.cronapi.screen.getValueOfField=function(field){try{return field&&field.length>0?field.indexOf("vars.")>-1?eval("this."+field):eval(field):""}catch(t){alert(t)}},this.cronapi.screen.createScopeVariable=function(t,e){this.cronapi.$scope.vars[t]=e},this.cronapi.screen.getScopeVariable=function(t){return this.cronapi.$scope.vars[t]},this.cronapi.screen.notify=function(t,e){this.cronapi.$scope.Notification({message:e.toString()},t)},this.cronapi.screen.datasourceFromScreen=function(t){return t},this.cronapi.screen.startInsertingMode=function(t){window[t].$apply(function(){window[t].startInserting()})},this.cronapi.screen.startEditingMode=function(t){window[t].$apply(new function(){window[t].startEditing()})},this.cronapi.screen.previusRecord=function(t){window[t].$apply(new function(){window[t].previous()})},this.cronapi.screen.nextRecord=function(t){window[t].$apply(new function(){window[t].next()})},this.cronapi.screen.removeRecord=function(t){window[t].$apply(new function(){window[t].remove()})},this.cronapi.screen.refreshActiveRecord=function(t){window[t].refreshActive()},this.cronapi.screen.hasNextRecord=function(t){return window[t].hasNext()},this.cronapi.screen.quantityRecords=function(t){return window[t].data.length},this.cronapi.screen.post=function(t){return window[t].post()},this.cronapi.screen.filter=function(t,e){window[t].filter("/"+e)},this.cronapi.screen.changeView=function(t,e){try{var n="?";for(var i in Object.keys(e)){var r=Object.keys(e[i])[0],o=String(Object.values(e[i])[0]);n+="#key#=#value#&".replace("#key#",this.cronapi.internal.Url.encode(r)).replace("#value#",this.cronapi.internal.Url.encode(o))}window.location.hash=t+n}catch(t){alert(t)}},this.cronapi.screen.openUrl=function(t,e,n,i){try{var r="_self",o="";e&&"true"==e.toString().toLowerCase()&&(r="_blank"),n&&(o+="width="+n+","),i&&(o+="height="+i+","),window.open(t,r,o)}catch(t){alert(t)}},this.cronapi.screen.getParam=function(t){try{for(var e,n=[],i=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),r=0;r<i.length;r++)e=i[r].split("="),n.push(e[0]),n[e[0]]=e[1];if(void 0!==n[t])return decodeURIComponent(n[t])}catch(t){}return null},this.cronapi.screen.confimDialog=function(t){return confirm(t)},this.cronapi.screen.createDefaultModal=function(t,e,n,i,r,o,a){$("#modalTemplateTitle").text(t),$("#modalTemplateBody").text(e),$("#modalTemplateCancel").text(n),$("#modalTemplateSave").text(i),$("#modalTemplateClose").unbind("click"),$("#modalTemplateClose").click(a),$("#modalTemplateCancel").unbind("click"),$("#modalTemplateCancel").click(o),$("#modalTemplateSave").unbind("click"),$("#modalTemplateSave").click(r),$("#modalTemplate").modal("show")},this.cronapi.screen.showModal=function(t){$("#"+t).modal("show")},this.cronapi.screen.searchIds=function(){},this.cronapi.screen.showComponent=function(t){$("#"+t).get(0).style.setProperty("display","block","important")},this.cronapi.screen.hideComponent=function(t){$("#"+t).get(0).style.setProperty("display","none","important")},this.cronapi.screen.disableComponent=function(t){$.each($("#"+t).find("*").addBack(),function(t,e){$(e).prop("disabled",!0)})},this.cronapi.screen.enableComponent=function(t){$.each($("#"+t).find("*").addBack(),function(t,e){$(e).prop("disabled",!1)})},this.cronapi.screen.changeAttrValue=function(t,e,n){$("#"+t).attr(e,n)},this.cronapi.dateTime={},this.cronapi.dateTime.utcTimestamp=!0,this.cronapi.dateTime.formats=function(){var t=[];return t="pt_br"==this.cronapi.$translate.use()?["DD/MM/YYYY HH:mm:ss","DD/MM/YYYY","DD-MM-YYYY HH:mm:ss","DD-MM-YYYY"]:["MM/DD/YYYY HH:mm:ss","MM/DD/YYYY","MM-DD-YYYY HH:mm:ss","MM-DD-YYYY"],t.push("YYYY-MM-DDTHH:mm:ss"),t.push("HH:mm:ss"),t.push("MMMM"),t},this.cronapi.dateTime.getMomentObj=function(t){var e=moment;if(this.cronapi.dateTime.utcTimestamp&&(e=moment.utc),t instanceof moment)return t;if(t instanceof Date)return e(t);var n=this.cronapi.dateTime.formats(),i=null;for(var r in n)if(i=e(t,n[r]),i.isValid())break;return i},this.cronapi.dateTime.getSecond=function(t){var e=this.cronapi.dateTime.getMomentObj(t);return e?e.get("second"):0},this.cronapi.dateTime.getMinute=function(t){var e=this.cronapi.dateTime.getMomentObj(t);return e?e.get("minute"):0},this.cronapi.dateTime.getHour=function(t){var e=this.cronapi.dateTime.getMomentObj(t);return e?e.get("hour"):0},this.cronapi.dateTime.getYear=function(t){var e=this.cronapi.dateTime.getMomentObj(t);return e?e.get("year"):0},this.cronapi.dateTime.getMonth=function(t){var e=this.cronapi.dateTime.getMomentObj(t);return e?e.get("month")+1:0},this.cronapi.dateTime.getDay=function(t){var e=this.cronapi.dateTime.getMomentObj(t);return e?e.get("date"):0},this.cronapi.dateTime.getSecondsBetweenDates=function(t,e){var n=this.cronapi.dateTime.getMomentObj(t),i=this.cronapi.dateTime.getMomentObj(e);return n.diff(i,"seconds")},this.cronapi.dateTime.getMinutesBetweenDates=function(t,e){var n=this.cronapi.dateTime.getMomentObj(t),i=this.cronapi.dateTime.getMomentObj(e);return n.diff(i,"minutes")},this.cronapi.dateTime.getHoursBetweenDates=function(t,e){var n=this.cronapi.dateTime.getMomentObj(t),i=this.cronapi.dateTime.getMomentObj(e);return n.diff(i,"hours")},this.cronapi.dateTime.getDaysBetweenDates=function(t,e){var n=this.cronapi.dateTime.getMomentObj(t),i=this.cronapi.dateTime.getMomentObj(e);return n.diff(i,"days")},this.cronapi.dateTime.getMonthsBetweenDates=function(t,e){var n=this.cronapi.dateTime.getMomentObj(t),i=this.cronapi.dateTime.getMomentObj(e);return n.diff(i,"months")},this.cronapi.dateTime.getYearsBetweenDates=function(t,e){var n=this.cronapi.dateTime.getMomentObj(t),i=this.cronapi.dateTime.getMomentObj(e);return n.diff(i,"years")},this.cronapi.dateTime.incSecond=function(t,e){return this.cronapi.dateTime.getMomentObj(t).add("seconds",e).toDate()},this.cronapi.dateTime.incMinute=function(t,e){return this.cronapi.dateTime.getMomentObj(t).add("minutes",e).toDate()},this.cronapi.dateTime.incHour=function(t,e){return this.cronapi.dateTime.getMomentObj(t).add("hours",e).toDate()},this.cronapi.dateTime.incDay=function(t,e){return this.cronapi.dateTime.getMomentObj(t).add("days",e).toDate()},this.cronapi.dateTime.incMonth=function(t,e){return this.cronapi.dateTime.getMomentObj(t).add("months",e).toDate()},this.cronapi.dateTime.incYear=function(t,e){return this.cronapi.dateTime.getMomentObj(t).add("years",e).toDate()},this.cronapi.dateTime.getNow=function(){return this.cronapi.dateTime.getMomentObj((new Date).toLocaleString()).toDate()},this.cronapi.dateTime.formatDateTime=function(date,format){format=format.toLowerCase(),format.indexOf(":mm")>-1&&(format=this.cronapi.internal.replaceAll(format,":mm",":minutes")),format=this.cronapi.internal.replaceAll(format," ",'+" "+'),format=this.cronapi.internal.replaceAll(format,":",'+":"+');for(var dateVar=this.cronapi.dateTime.getMomentObj(date),dd=dateVar.get("date"),mm=dateVar.get("month")+1,yyyy=dateVar.get("year"),hh=dateVar.get("hour"),minutes=dateVar.get("minute"),ss=dateVar.get("second"),separator="",maskChars="dmy",i=0;i<format.length;i++)if(!maskChars.includes(format.charAt(i))){separator=format.charAt(i);var formatLower=this.cronapi.internal.replaceAll(format,separator,"+separator+");return eval(formatLower)}return""},this.cronapi.dateTime.newDate=function(t,e,n,i,r,o){var a=new Date;return a.setYear(t),a.setMonth(e-1),a.setDate(n),a.setHours(i),a.setMinutes(r),a.setSeconds(o),this.cronapi.dateTime.getMomentObj(a.toLocaleString()).toDate()},this.cronapi.text={},this.cronapi.text.prompt=function(t){return null},this.cronapi.xml={},this.cronapi.xml.newXMLEmpty=function(){return $.parseXML('<?xml version="1.0" encoding="UTF-8"?><root></root>')},this.cronapi.xml.newXMLEmptyWithRoot=function(t){var e=$.parseXML('<?xml version="1.0" encoding="UTF-8"?><root></root>');return e.removeChild(e.firstElementChild),e.appendChild(t),e},this.cronapi.xml.newXMLElement=function(t,e){var n=document.createElement(t);return n.textContent=e,n},this.cronapi.xml.addXMLElement=function(t,e){try{var n=e.cloneNode(!0);return t.appendChild(n),!0}catch(t){return!1}},this.cronapi.xml.XMLHasRootElement=function(t){return!(!t||!t.getRootNode())},this.cronapi.xml.XMLGetRootElement=function(t){return t instanceof XMLDocument?t.firstElementChild:t.getRootNode()},this.cronapi.xml.XMLDocumentToText=function(t){if(t instanceof XMLDocument)return $($($(t.firstElementChild).context.outerHTML).removeAttr("xmlns"))[0].outerHTML;if($(t).size()>1){var e="";return $.each($(t).toArray(),function(t,n){e+=$($(n)[0].outerHTML).removeAttr("xmlns")[0].outerHTML}),e}return $($($(t).context.outerHTML).removeAttr("xmlns"))[0].outerHTML},this.cronapi.xml.getChildren=function(t,e){return t instanceof XMLDocument?t.firstElementChild.toArray:e?e.localName?$(t).find(e.localName).toArray():$(t).find(e).toArray():$(t).children().toArray()},this.cronapi.xml.setAttribute=function(t,e,n){return!!e&&(t instanceof XMLDocument?(t.firstChild.setAttribute(e,n),!0):!!t&&(t.setAttribute(e,n),!0))},this.cronapi.xml.getAttributeValue=function(t,e){return e?t instanceof XMLDocument?t.firstChild.getAttribute(e)?t.firstChild.getAttribute(e):"":t&&e?t.getAttribute(e):"":""},this.cronapi.xml.getParentNode=function(t){return t instanceof XMLDocument?t.firstChild:t.parentNode},this.cronapi.xml.setElementContent=function(t,e){t instanceof XMLDocument&&(t.firstChild.textContent=e),t.textContent=e},this.cronapi.xml.getElementContent=function(t){return t instanceof XMLDocument?t.firstChild.innerText:t.innerText},this.cronapi.xml.removeElement=function(t,e){t instanceof XMLDocument?e?e instanceof HTMLUnknownElement?e.remove():$.each($(t.firstElementChild.children),function(t,n){n.localName==e&&n.remove()}):$.each($(t.firstElementChild.children),function(t,e){e.remove()}):e?e instanceof HTMLUnknownElement?e.remove():$.each($(t.children),function(t,n){n.localName==e&&n.remove()}):$.each($(t.children),function(t,e){e.remove()})},this.cronapi.xml.getElementName=function(t){return t instanceof XMLDocument?t.firstChild.localName:t.localName},this.cronapi.xml.renameElement=function(t,e){var n=t.outerHTML.replace(t.localName,e);n=n.replace("/"+t.localName,"/"+e),n=$(n).removeAttr("xmlns"),t.replaceWith(n[0])},this.cronapi.logic={},this.cronapi.logic.isNull=function(t){return null===t||void 0===t},this.cronapi.logic.isEmpty=function(t){return""===t},this.cronapi.logic.isNullOrEmpty=function(t){return this.cronapi.logic.isNull(t)||this.cronapi.logic.isEmpty(t)},this.cronapi.i18n={},this.cronapi.i18n.translate=function(t,e){if(t){for(var n=this.cronapi.$translate.instant(t),i=0;i<e.length;i++){var r=e[i];if(null!=r&&void 0!==r){var o=new RegExp("\\{"+i+"\\}","g");n=n.replace(o,r)}}return n}},this.cronapi.internal={},this.cronapi.internal.setFile=function(t,e){this.cronapi.internal.fileToBase64(e,function(e){this.cronapi.screen.changeValueOfField(t,e)}.bind(this))},this.cronapi.internal.fileToBase64=function(t,e){var n=new FileReader;n.readAsDataURL(t),n.onload=function(t){var n=t.target.result.substr(t.target.result.indexOf("base64,")+"base64,".length);e(n)}},this.cronapi.internal.startCamera=function(t){function e(t,e){var n=window.innerWidth,i=window.innerHeight,r=0;return r=n/t,e*=r,t*=r,t>n&&(r=n/t,e*=r,t*=r),e>i&&(r=i/e,t*=r,e*=r),{width:t,height:e}}var n='<div class="camera-container" style="margin-left:-$marginleft$;margin-top:-$margintop$">                                    <div class="btn btn-success" id="cronapiVideoCaptureOk" style="position: absolute; z-index: 999999999;">                                        <span class="glyphicon glyphicon-ok"></span>                                    </div>                                    <div class="btn btn-danger" id="cronapiVideoCaptureCancel" style="position: absolute; margin-left: 42px; z-index: 999999999;">                                        <span class="glyphicon glyphicon-remove"></span>                                    </div>                                    <video id="cronapiVideoCapture" style="height: $height$; width: $width$;" autoplay=""></video>                            </div>',i=null,r={video:!0};navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&navigator.mediaDevices.getUserMedia(r).then(function(r){i=r;var o=e(r.getTracks()[0].getSettings().width,r.getTracks()[0].getSettings().height),a=o.width,c=o.height;try{a=parseInt(a/2),c=parseInt(c/2)}catch(t){}n=n.split("$height$").join(o.height+"px").split("$width$").join(o.width+"px").split("$marginleft$").join(a+"px").split("$margintop$").join(c+"px");var s=$(n);s.prependTo("body");var l=document.getElementById("cronapiVideoCapture");s.find("#cronapiVideoCaptureCancel").on("click",function(){null!=i&&i.getTracks().length>0&&i.getTracks()[0].stop(),$(s).remove()}.bind(this)),s.find("#cronapiVideoCaptureOk").on("click",function(){this.cronapi.internal.captureFromCamera(t,o.width,o.height),null!=i&&i.getTracks().length>0&&i.getTracks()[0].stop(),$(s).remove()}.bind(this)),l.src=window.URL.createObjectURL(r),l.play()}.bind(this))},this.cronapi.internal.captureFromCamera=function(t,e,n){var i=document.createElement("canvas");i.width=e,i.height=n;var r=i.getContext("2d"),o=document.getElementById("cronapiVideoCapture");r.drawImage(o,0,0,e,n);var a=i.toDataURL().substr(22);this.cronapi.screen.changeValueOfField(t,a)},this.cronapi.internal.castBase64ToByteArray=function(t){for(var e=window.atob(t),n=e.length,i=new Uint8Array(n),r=0;r<n;r++)i[r]=e.charCodeAt(r);return i},this.cronapi.internal.castByteArrayToString=function(t){return String.fromCharCode.apply(null,new Uint16Array(t))},this.cronapi.internal.generatePreviewDescriptionByte=function(t){var e;try{e=JSON.parse(t)}catch(a){try{e=JSON.parse(this.cronapi.internal.castByteArrayToString(this.cronapi.internal.castBase64ToByteArray(t)))}catch(a){if(t&&t.indexOf("dropboxusercontent")>-1){e={};var n=t.split("/"),i=n[n.length-1].replace("?dl=0",""),r=i.split("."),o="."+r[r.length-1];e.fileExtension=o,e.name=i.replace(o,""),e.contentType="file/"+o.replace(".","")}}}if(e){e.name.length>25&&(e.name=e.name.substr(0,22)+"...");var a="<b>Nome:</b> <br/>"+e.name+"<br/>";return a+="<b>Content-Type:</b> <br/>"+e.contentType+"<br/>",a+="<b>Extensão:</b> <br/>"+e.fileExtension+"<br/>"}},this.cronapi.internal.downloadFileEntity=function(t,e,n){var i,r,o=null;if(n)i=t.data[n][e],r=t.data[n];else try{i=t.active[e],r=t.active}catch(n){i=t[e],r=t}try{var o=JSON.parse(i)}catch(t){}if(o)window.open("/api/cronapi/filePreview/"+o.path);else if(i.indexOf("dropboxusercontent")>-1)window.open(i);else{var a="/api/cronapi/downloadFile",c=t.entity.split("/"),s=c[c.length-1];if(s.indexOf(":")>-1){for(var l="",p=c[3].split("."),u=0;u<p.length-1;u++)l+=p[u]+".";var d=s.split(":");s=l+d[d.length-1]}a+="/"+s,a+="/"+e;var h=JSON.parse(sessionStorage.getItem("_u")),m=r;this.$promise=this.cronapi.$scope.$http({method:"POST",url:(window.hostApp||"")+a,data:m?JSON.stringify(m):null,responseType:"blob",headers:{"Content-Type":"application/json","X-AUTH-TOKEN":h.token}}).success(function(t,e,n,i){n=n();var r=n["x-filename"]||"download.bin",o=(n["content-type"],window.URL||window.webkitURL||window.mozURL||window.msURL);try{var a=document.createElement("a");if("download"in a){var c=o.createObjectURL(t);a.setAttribute("href",c),a.setAttribute("download",r);var s=document.createEvent("MouseEvents");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,0,null),a.dispatchEvent(s)}}catch(t){console.log("Error downloading file"),console.log(t)}}.bind(this)).error(function(t,e,n,i){console.log("Error downloading file")}.bind(this))}},this.cronapi.internal.uploadFile=function(t,e,n){if(e){var i=new FormData;i.append("file",e);var r=JSON.parse(sessionStorage.getItem("_u"));this.$promise=this.cronapi.$scope.$http({method:"POST",url:(window.hostApp||"")+"/api/cronapi/uploadFile",data:i,headers:{"Content-Type":void 0,"X-AUTH-TOKEN":r.token},onProgress:function(t){if(t.lengthComputable){var e=t.loaded/t.total*100|0,i=$("#"+n);if(i.length>0)if("bootstrapProgress"==i.data("type"))e<100?(i.show(),i.find(".progress-bar").css("width",e+"%")):(i.hide(),i.find(".progress-bar").css("width","0%"));else{var r=document.getElementById(n);r.value=r.innerHTML=e}}}}).success(function(e,n,i,r){this.cronapi.screen.changeValueOfField(t,e.jsonString)}.bind(this)).error(function(t,e,n,i){alert("Error uploading file")}.bind(this))}},this.cronapi.object={},this.cronapi.object.getProperty=function(t,e){for(var n=e.split("."),i=0;i<n.length;i++)t=t[n[i]];return t},this.cronapi.object.setProperty=function(t,e,n){for(var i=e.split("."),r=0;r<i.length;r++)t=t[i[r]];t=n},this.cronapi.cordova={},this.cronapi.cordova.vibrate=function(t){navigator.vibrate(t)},this.cronapi.cordova.geolocation={},this.cronapi.cordova.geolocation.getCurrentPosition=function(t,e){navigator.geolocation.getCurrentPosition(t,e)},this.cronapi.cordova.geolocation.watchPosition=function(t,e,n,i,r){return navigator.geolocation.watchPosition(callbackSuccess,callbackError,{maximumAge:n,timeout:i,enableHighAccuracy:r})},this.cronapi.cordova.geolocation.clearWatchPosition=function(t){navigator.geolocation.clearWatch(t)},this.cronapi.cordova.camera={},this.cronapi.cordova.camera.getPicture=function(t,e,n,i){navigator.camera.getPicture(t,e,{destinationType:n,sourceType:i})},this.cronapi.cordova.camera.qrCodeScanner=function(t,e,n,i){cordova.plugins.barcodeScanner.scan(function(t){n(t.text)},function(t){i(t)},{preferFrontCamera:!1,showFlipCameraButton:!0,showTorchButton:!0,torchOn:!0,saveHistory:!0,prompt:e,resultDisplayDuration:500,formats:t,orientation:"portrait",disableAnimations:!0,disableSuccessBeep:!1})},this.cronapi.cordova.file={},this.cronapi.cordova.file.getDirectory=function(t){var e;return"0"==t?e=cordova.file.dataDirectory:(e=cordova.file.externalApplicationStorageDirectory,e||(e=cordova.file.externalDataDirectory),e||(e=cordova.file.syncedDataDirectory)),e},this.cronapi.cordova.file.removeFile=function(t,e,n){window.resolveLocalFileSystemURL(t,function(t){t.remove(function(t){e&&e(t)}.bind(this),n)}.bind(this),n)},this.cronapi.cordova.file.readFile=function(t,e,n){window.resolveLocalFileSystemURL(t,function(t){t.file(function(t){var n=new FileReader;n.onloadend=function(t){e(this.result)},n.readAsText(t)}.bind(this),n)}.bind(this),n)},this.cronapi.cordova.file.createFile=function(t,e,n,i,r){t||getDirectory(0);window.resolveLocalFileSystemURL(t,function(o){console.log(t),o.getFile(e,{create:!0},function(t){t.createWriter(function(t){t.onwriteend=function(t){console.log('Write of file "'+e+'"" completed.')},t.onerror=function(t){console.log("Write failed: "+t.toString())};var r=new Blob([n],{type:"text/plain"});t.write(r),i&&setTimeout(function(){i()}.bind(this),500)}.bind(this),r)}.bind(this),r)}.bind(this),r)},this.cronapi.cordova.file.createDirectory=function(t,e,n,i){window.resolveLocalFileSystemURL(t,function(t){parentEntry.getDirectory(e,{create:!0},function(t){n&&n(t)}.bind(this),i)}.bind(this),i)},this.cronapi.cordova.storage={},this.cronapi.cordova.storage.setStorageItem=function(t,e){var n=window.localStorage;n?n.setItem(t,e):console.error("Local Storage not Found!")},this.cronapi.cordova.storage.getStorageItem=function(t){var e=window.localStorage;if(e)return e.getItem(t);console.error("Local Storage not Found!")},this.cronapi.cordova.storage.removeStorageItem=function(t){var e=window.localStorage;e?e.removeItem(t):console.error("Local Storage not Found!")},this.cronapi.cordova.connection={},this.cronapi.cordova.connection.getConnection=function(){return navigator.connection.type},this.cronapi.cordova.connection.verifyConnection=function(t){return navigator.connection.type==t},this.cronapi.cordova.database={},this.cronapi.cordova.database.nameDefault="cronappDB",this.cronapi.cordova.database.openDatabase=function(t){t||(this.cronapi.cordova.database.name=this.cronapi.cordova.database.nameDefault,window.BuildInfo&&(this.cronapi.cordova.database.name=BuildInfo.packageName)),this.cronapi.cordova.database.object=window.openDatabase({name:this.cronapi.cordova.database.name})},this.cronapi.cordova.database.executeSql=function(t,e,n,i){this.cronapi.cordova.database.object||this.cronapi.cordova.database.openDatabase(),this.cronapi.cordova.database.object.transaction(function(i){i.executeSql(t,e,n)}.bind(this),function(t){console.log(t),i(t)}.bind(this))},this.cronapi.internal.ptDate=function(t){var e=t[1],n=t[2],i=t[3],r=t[5],o=t[6],a=t[7];return r?new Date(i,n-1,e,r,o,a):new Date(i,n-1,e,0,0,0)},this.cronapi.internal.enDate=function(t){var e=t[1],n=t[2],i=t[3],r=t[5],o=t[6],a=t[7];return r?new Date(i,e-1,n,r,o,a):new Date(i,e-1,n,0,0,0)},this.cronapi.internal.parseBoolean=function(t){return!!t&&("boolean"==typeof t?t:"1"==(t=t.toString().toLowerCase().trim())||"true"==t)},this.cronapi.internal.removeAccents=function(t){for(withAccents="áàãâäéèêëíìîïóòõôöúùûüçÁÀÃÂÄÉÈÊËÍÌÎÏÓÒÕÖÔÚÙÛÜÇ",withoutAccents="aaaaaeeeeiiiiooooouuuucAAAAAEEEEIIIIOOOOOUUUUC",newValue="",i=0;i<t.length;i++)withAccents.search(t.substr(i,1))>=0?newValue+=withoutAccents.substr(withAccents.search(t.substr(i,1)),1):newValue+=t.substr(i,1);return newValue},this.cronapi.internal.arrayRemove=function(t,e){var n=this.cronapi.internal.arrayIndexOf(t,e);-1!=n&&t.splice(n,1)},this.cronapi.internal.arrayIndexOf=function(t,e){var n=-1;return $(t).each(function(t){e==this&&(n=t)}),n},this.cronapi.internal.replaceAll=function(t,e,n){return t.toString().split(e).join(n)},this.cronapi.internal.getWindowHeight=function(){$(window).height()},this.cronapi.internal.getWindowWidth=function(){$(window).width()},this.cronapi.internal.Url={encode:function(t){return t?escape(this.cronapi.internal.Url._utf8_encode(t)):""},decode:function(t){return t?this.cronapi.internal.Url._utf8_decode(unescape(t)):""},_utf8_encode:function(t){t=t.replace(/\r\n/g,"\n");for(var e="",n=0;n<t.length;n++){var i=t.charCodeAt(n);i<128?e+=String.fromCharCode(i):i>127&&i<2048?(e+=String.fromCharCode(i>>6|192),e+=String.fromCharCode(63&i|128)):(e+=String.fromCharCode(i>>12|224),e+=String.fromCharCode(i>>6&63|128),e+=String.fromCharCode(63&i|128))}return e},_utf8_decode:function(t){for(var e="",n=0,i=c1=c2=0;n<t.length;)i=t.charCodeAt(n),i<128?(e+=String.fromCharCode(i),n++):i>191&&i<224?(c2=t.charCodeAt(n+1),e+=String.fromCharCode((31&i)<<6|63&c2),n+=2):(c2=t.charCodeAt(n+1),c3=t.charCodeAt(n+2),e+=String.fromCharCode((15&i)<<12|(63&c2)<<6|63&c3),n+=3);return e}},this.cronapi.internal.stringToJs=function(t){return(t+"").replace(/[\\"']/g,"\\$&").replace(/\u0000/g,"\\0")},this.cronapi.internal.getErrorMessage=function(t,e){try{var n=JSON.parse(t);if(n&&n.error)return n.error}catch(t){}return e},this.cronapi.util.upload=function(t,e,n,i,r){this.UploadService.upload({description:e,id:t,filter:n,maxSize:i,multiple:r})}}).bind(window)();